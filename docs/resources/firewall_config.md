---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "vercel_firewall_config Resource - terraform-provider-vercel"
subcategory: ""
description: |-
  Define Custom Rules to shape the way your traffic is handled by the Vercel Edge Network.
---

# vercel_firewall_config (Resource)

Define Custom Rules to shape the way your traffic is handled by the Vercel Edge Network.

## Example Usage

```terraform
resource "vercel_project" "example" {
  name = "firewall-config-example"
}

resource "vercel_firewall_config" "example" {
  project_id = vercel_project.example.id

  rules {
    rule {
      name        = "Bypass Known request"
      description = "Bypass requests using internal bearer tokens"
      # individual condition groups are evaluated as ORs
      condition_group = [
        {
          conditions = [{
            type  = "header"
            key   = "Authorization"
            op    = "eq"
            value = "Bearer internaltoken"
          }]
        },
        {
          conditions = [{
            type  = "header"
            key   = "Authorization"
            op    = "eq"
            value = "Bearer internaltoken2"
          }]
        }
      ]
      action = {
        action = "bypass"
      }
    }

    rule {
      name        = "Challenge curl"
      description = "Challenge user agents containing 'curl'"
      condition_group = [{
        conditions = [{
          type  = "user_agent"
          op    = "sub"
          value = "curl"
        }]
      }]
      action = {
        action = "challenge"
      }
    }

    rule {
      name        = "Deny cookieless requests"
      description = "requests to /api that are missing a session cookie"
      # multiple conditions in a single condition group are evaluated as ANDs
      condition_group = [{
        conditions = [{
          type  = "path"
          op    = "eq"
          value = "/api"
          },
          {
            # Use 'nex' (not exists) to check if cookie is missing
            # Note: no 'value' field needed for existence operators (ex/nex)
            type = "cookie"
            key  = "_session"
            neg  = true
            op   = "ex"
        }]
      }]
      action = {
        action = "challenge"
      }
    }

    rule {
      name        = "Require Authorization header"
      description = "Block requests without Authorization header"
      condition_group = [{
        conditions = [{
          # 'nex' (not exists) checks if header is absent
          type = "header"
          key  = "Authorization"
          op   = "nex"
        }]
      }]
      action = {
        action = "deny"
      }
    }

    rule {
      name        = "Log requests with custom header"
      description = "Log requests that have X-Custom-Header present"
      condition_group = [{
        conditions = [{
          # 'ex' (exists) checks if header is present
          type = "header"
          key  = "X-Custom-Header"
          op   = "ex"
        }]
      }]
      action = {
        action = "log"
      }
    }

    rule {
      name        = "Rate limit API"
      description = "apply ratelimit to requests under /api"
      condition_group = [{
        conditions = [{
          type  = "path"
          op    = "pre"
          value = "/api"
        }]
      }]

      action = {
        action = "rate_limit"
        rate_limit = {
          limit  = 100
          window = 300
          keys   = ["ip", "ja4"]
          algo   = "fixed_window"
          action = "deny"
        }
        action_duration = "5m"
      }
    }

    rule {
      name        = "Known clients"
      description = "Match known keys in header"
      condition_group = [{
        conditions = [{
          type = "header"
          key  = "Authorization"
          op   = "inc"
          values = [
            "key1",
            "key2",
          ]
        }]
      }]

      action = {
        action = "rate_limit"
        rate_limit = {
          limit  = 100
          window = 300
          keys   = ["ip", "ja4"]
          algo   = "fixed_window"
          action = "deny"
        }
        action_duration = "5m"
      }
    }
  }
}

resource "vercel_project" "managed_example" {
  name = "firewall-managed-rule-example"
}

resource "vercel_firewall_config" "managed" {
  project_id = vercel_project.managed.id

  managed_rulesets {
    owasp {
      xss  = { action = "deny" }
      sqli = { action = "deny" }
      rce  = { action = "deny" }
      php  = { action = "deny" }
      java = { action = "deny" }
      lfi  = { action = "deny" }
      rfi  = { action = "deny" }
      gen  = { action = "deny" }
    }

    bot_protection {
      action = "log"
      active = true
    }

    ai_bots {
      action = "log"
      active = true
    }
  }
}

resource "vercel_project" "ip_example" {
  name = "firewall-ip-blocking-example"
}

resource "vercel_firewall_config" "ip-blocking" {
  project_id = vercel_project.ip_example.id

  ip_rules {
    # deny this subnet for all my hosts
    rule {
      action   = "deny"
      ip       = "51.85.0.0/16"
      hostname = "*"
    }

    rule {
      action   = "challenge"
      ip       = "1.2.3.4"
      hostname = "example.com"
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `project_id` (String) The ID of the project this configuration belongs to.

### Optional

- `enabled` (Boolean) Whether firewall is enabled or not.
- `ip_rules` (Block, Optional) IP rules to apply to the project. (see [below for nested schema](#nestedblock--ip_rules))
- `managed_rulesets` (Block, Optional) The managed rulesets that are enabled. (see [below for nested schema](#nestedblock--managed_rulesets))
- `rules` (Block, Optional) Custom rules to apply to the project (see [below for nested schema](#nestedblock--rules))
- `team_id` (String) The ID of the team this project belongs to.

<a id="nestedblock--ip_rules"></a>
### Nested Schema for `ip_rules`

Optional:

- `rule` (Block List) (see [below for nested schema](#nestedblock--ip_rules--rule))

<a id="nestedblock--ip_rules--rule"></a>
### Nested Schema for `ip_rules.rule`

Required:

- `action` (String)
- `hostname` (String) Hosts to apply these rules to
- `ip` (String) IP or CIDR to block

Optional:

- `notes` (String)

Read-Only:

- `id` (String)



<a id="nestedblock--managed_rulesets"></a>
### Nested Schema for `managed_rulesets`

Optional:

- `ai_bots` (Block, Optional) Enable the ai_bots managed ruleset and select action (see [below for nested schema](#nestedblock--managed_rulesets--ai_bots))
- `bot_filter` (Block, Optional, Deprecated) DEPRECATED: Use bot_protection instead. This block will be removed in a future release. (see [below for nested schema](#nestedblock--managed_rulesets--bot_filter))
- `bot_protection` (Block, Optional) Enable the bot_protection managed ruleset and select action (see [below for nested schema](#nestedblock--managed_rulesets--bot_protection))
- `owasp` (Block, Optional) Enable the owasp managed rulesets and select ruleset behaviors (see [below for nested schema](#nestedblock--managed_rulesets--owasp))

<a id="nestedblock--managed_rulesets--ai_bots"></a>
### Nested Schema for `managed_rulesets.ai_bots`

Optional:

- `action` (String)
- `active` (Boolean)


<a id="nestedblock--managed_rulesets--bot_filter"></a>
### Nested Schema for `managed_rulesets.bot_filter`

Optional:

- `action` (String)
- `active` (Boolean)


<a id="nestedblock--managed_rulesets--bot_protection"></a>
### Nested Schema for `managed_rulesets.bot_protection`

Optional:

- `action` (String)
- `active` (Boolean)


<a id="nestedblock--managed_rulesets--owasp"></a>
### Nested Schema for `managed_rulesets.owasp`

Optional:

- `gen` (Attributes) Generic Attack Detection (see [below for nested schema](#nestedatt--managed_rulesets--owasp--gen))
- `java` (Attributes) Java Attack Detection (see [below for nested schema](#nestedatt--managed_rulesets--owasp--java))
- `lfi` (Attributes) Local File Inclusion Rules (see [below for nested schema](#nestedatt--managed_rulesets--owasp--lfi))
- `ma` (Attributes) Multipart Rules (see [below for nested schema](#nestedatt--managed_rulesets--owasp--ma))
- `php` (Attributes) PHP Attack Detection (see [below for nested schema](#nestedatt--managed_rulesets--owasp--php))
- `rce` (Attributes) Remote Code Execution Rules (see [below for nested schema](#nestedatt--managed_rulesets--owasp--rce))
- `rfi` (Attributes) Remote File Inclusion Rules (see [below for nested schema](#nestedatt--managed_rulesets--owasp--rfi))
- `sd` (Attributes) Scanner Detection Rules (see [below for nested schema](#nestedatt--managed_rulesets--owasp--sd))
- `sqli` (Attributes) SQL Injection Rules (see [below for nested schema](#nestedatt--managed_rulesets--owasp--sqli))
- `xss` (Attributes) Cross Site Scripting Rules (see [below for nested schema](#nestedatt--managed_rulesets--owasp--xss))

<a id="nestedatt--managed_rulesets--owasp--gen"></a>
### Nested Schema for `managed_rulesets.owasp.gen`

Required:

- `action` (String)

Optional:

- `active` (Boolean)


<a id="nestedatt--managed_rulesets--owasp--java"></a>
### Nested Schema for `managed_rulesets.owasp.java`

Required:

- `action` (String)

Optional:

- `active` (Boolean)


<a id="nestedatt--managed_rulesets--owasp--lfi"></a>
### Nested Schema for `managed_rulesets.owasp.lfi`

Required:

- `action` (String)

Optional:

- `active` (Boolean)


<a id="nestedatt--managed_rulesets--owasp--ma"></a>
### Nested Schema for `managed_rulesets.owasp.ma`

Required:

- `action` (String)

Optional:

- `active` (Boolean)


<a id="nestedatt--managed_rulesets--owasp--php"></a>
### Nested Schema for `managed_rulesets.owasp.php`

Required:

- `action` (String)

Optional:

- `active` (Boolean)


<a id="nestedatt--managed_rulesets--owasp--rce"></a>
### Nested Schema for `managed_rulesets.owasp.rce`

Required:

- `action` (String)

Optional:

- `active` (Boolean)


<a id="nestedatt--managed_rulesets--owasp--rfi"></a>
### Nested Schema for `managed_rulesets.owasp.rfi`

Required:

- `action` (String)

Optional:

- `active` (Boolean)


<a id="nestedatt--managed_rulesets--owasp--sd"></a>
### Nested Schema for `managed_rulesets.owasp.sd`

Required:

- `action` (String)

Optional:

- `active` (Boolean)


<a id="nestedatt--managed_rulesets--owasp--sqli"></a>
### Nested Schema for `managed_rulesets.owasp.sqli`

Required:

- `action` (String)

Optional:

- `active` (Boolean)


<a id="nestedatt--managed_rulesets--owasp--xss"></a>
### Nested Schema for `managed_rulesets.owasp.xss`

Required:

- `action` (String)

Optional:

- `active` (Boolean)




<a id="nestedblock--rules"></a>
### Nested Schema for `rules`

Optional:

- `rule` (Block List) (see [below for nested schema](#nestedblock--rules--rule))

<a id="nestedblock--rules--rule"></a>
### Nested Schema for `rules.rule`

Required:

- `action` (Attributes) Actions to take when the condition groups match a request (see [below for nested schema](#nestedatt--rules--rule--action))
- `condition_group` (Attributes List) Sets of conditions that may match a request (see [below for nested schema](#nestedatt--rules--rule--condition_group))
- `name` (String) Name to identify the rule

Optional:

- `active` (Boolean) Rule is active or disabled
- `description` (String)

Read-Only:

- `id` (String)

<a id="nestedatt--rules--rule--action"></a>
### Nested Schema for `rules.rule.action`

Required:

- `action` (String) Base action

Optional:

- `action_duration` (String) Forward persistence of a rule action
- `rate_limit` (Attributes) Behavior or a rate limiting action. Required if action is rate_limit (see [below for nested schema](#nestedatt--rules--rule--action--rate_limit))
- `redirect` (Attributes) How to redirect a request. Required if action is redirect (see [below for nested schema](#nestedatt--rules--rule--action--redirect))

<a id="nestedatt--rules--rule--action--rate_limit"></a>
### Nested Schema for `rules.rule.action.rate_limit`

Required:

- `action` (String) Action to take when rate limit is exceeded
- `algo` (String) Rate limiting algorithm
- `keys` (List of String) Keys used to bucket an individual client
- `limit` (Number) number of requests allowed in the window
- `window` (Number) Time window in seconds


<a id="nestedatt--rules--rule--action--redirect"></a>
### Nested Schema for `rules.rule.action.redirect`

Required:

- `location` (String)
- `permanent` (Boolean)



<a id="nestedatt--rules--rule--condition_group"></a>
### Nested Schema for `rules.rule.condition_group`

Required:

- `conditions` (Attributes List) Conditions that must all match within a group (see [below for nested schema](#nestedatt--rules--rule--condition_group--conditions))

<a id="nestedatt--rules--rule--condition_group--conditions"></a>
### Nested Schema for `rules.rule.condition_group.conditions`

Required:

- `op` (String) Operator to use for comparison. Options: `re` (regex), `eq` (equals), `neq` (not equals), `ex` (exists), `nex` (not exists), `inc` (includes), `ninc` (not includes), `pre` (prefix), `suf` (suffix), `sub` (substring), `gt` (greater than), `gte` (greater than or equal), `lt` (less than), `lte` (less than or equal). Note: `ex` and `nex` don't require a `value` field, only `key`.
- `type` (String) Request key type to match against

Optional:

- `key` (String) Key within type to match against
- `neg` (Boolean) Negate the condition
- `value` (String) Value to match against. Not required for existence operators (`ex`, `nex`). Use `values` instead for `inc` and `ninc` operators.
- `values` (List of String) Values to match against if op is inc, ninc

## Import

Import is supported using the following syntax:

```shell
terraform import vercel_firewall_config.example team_xxxxxxxxxxxxxxxxxxxxxxxx/prj_xxxxxxxxxxxxxxxxxxxxxxxxxxxx
```
