---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "vercel_drain Resource - terraform-provider-vercel"
subcategory: ""
description: |-
  Provides a Configurable Drain resource.
  Drains collect various types of data including logs, traces, analytics, and speed insights from your Vercel projects.
  This is a more generic version of log drains that supports multiple data types and delivery methods.
  Teams on Pro and Enterprise plans can create configurable drains from the Vercel dashboard.
  ~> Only Pro and Enterprise teams can create Configurable Drains.
---

# vercel_drain (Resource)

Provides a Configurable Drain resource.

Drains collect various types of data including logs, traces, analytics, and speed insights from your Vercel projects.
This is a more generic version of log drains that supports multiple data types and delivery methods.

Teams on Pro and Enterprise plans can create configurable drains from the Vercel dashboard.

~> Only Pro and Enterprise teams can create Configurable Drains.

## Example Usage

```terraform
resource "vercel_project" "example" {
  name = "example-project"
}

# Basic HTTP drain for logs
resource "vercel_drain" "basic_http" {
  name     = "basic-http-logs"
  projects = "all"

  schemas = {
    log = {
      version = "v1"
    }
  }

  delivery = {
    type = "http"
    endpoint = {
      url = "https://example.com/webhook"
    }
    encoding = "json"
    headers = {
      "Authorization" = "Bearer your-token"
    }
  }
}

# Advanced drain with multiple schemas and sampling
resource "vercel_drain" "advanced" {
  name        = "advanced-multi-schema"
  projects    = "some"
  project_ids = [vercel_project.example.id]
  filter      = "level >= 'info'"

  schemas = {
    log = {
      version = "v1"
    }
    trace = {
      version = "v1"
    }
    analytics = {
      version = "v1"
    }
    speed_insights = {
      version = "v1"
    }
  }

  delivery = {
    type = "http"
    endpoint = {
      url = "https://example.com/advanced-drain"
    }
    encoding    = "ndjson"
    compression = "gzip"
    headers = {
      "Authorization" = "Bearer advanced-token"
      "Content-Type"  = "application/x-ndjson"
      "X-Custom"      = "custom-header"
    }
    secret = "your-signing-secret-for-verification"
  }

  sampling = [
    {
      type        = "head_sampling"
      rate        = 0.1
      environment = "production"
    },
    {
      type         = "head_sampling"
      rate         = 0.5
      environment  = "preview"
      request_path = "/api/"
    }
  ]

  transforms = [
    {
      id = "transform-filter-pii"
    },
    {
      id = "transform-enrich-context"
    }
  ]
}

# OTLP HTTP drain for traces
resource "vercel_drain" "otlp_traces" {
  name     = "jaeger-traces"
  projects = "all"

  schemas = {
    trace = {
      version = "v1"
    }
  }

  delivery = {
    type = "otlphttp"
    endpoint = {
      traces = "https://jaeger.example.com/api/traces"
    }
    encoding = "proto"
    headers = {
      "Authorization" = "Bearer jaeger-token"
    }
  }

  sampling = [
    {
      type = "head_sampling"
      rate = 0.01 # 1% sampling for traces
    }
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `delivery` (Attributes) Configuration for how data should be delivered. (see [below for nested schema](#nestedatt--delivery))
- `name` (String) The name of the Drain.
- `projects` (String) Whether to include all projects or a specific set. Valid values are `all` or `some`.
- `schemas` (Map of Object) A map of schema configurations. Keys can be `log`, `trace`, `analytics`, or `speed_insights`. (see [below for nested schema](#nestedatt--schemas))

### Optional

- `filter` (String) A filter expression to apply to incoming data.
- `project_ids` (Set of String) A list of project IDs that the drain should be associated with. Required when `projects` is `some`.
- `sampling` (Attributes Set) Sampling configuration for the drain. (see [below for nested schema](#nestedatt--sampling))
- `team_id` (String) The ID of the team the Drain should exist under. Required when configuring a team resource if a default team has not been set in the provider.
- `transforms` (Attributes Set) Transform configurations for the drain. (see [below for nested schema](#nestedatt--transforms))

### Read-Only

- `id` (String) The ID of the Drain.
- `status` (String) The status of the drain.

<a id="nestedatt--delivery"></a>
### Nested Schema for `delivery`

Required:

- `type` (String) The delivery type. Valid values are `http` or `otlphttp`

Optional:

- `compression` (String) The compression method. Valid values are `gzip` or `none`.
- `encoding` (String) The encoding format. Valid values are `json`, `ndjson`, or `proto` (for OTLP).
- `endpoint` (Attributes) Endpoint configuration. Use `url` for HTTP or `traces` for OTLP. (see [below for nested schema](#nestedatt--delivery--endpoint))
- `headers` (Map of String) Custom headers to include in HTTP requests.
- `secret` (String, Sensitive) A secret for signing requests.

<a id="nestedatt--delivery--endpoint"></a>
### Nested Schema for `delivery.endpoint`

Optional:

- `traces` (String) The traces endpoint URL for OTLP delivery type.
- `url` (String) The endpoint URL for HTTP delivery type.



<a id="nestedatt--schemas"></a>
### Nested Schema for `schemas`

Required:

- `version` (String)


<a id="nestedatt--sampling"></a>
### Nested Schema for `sampling`

Required:

- `rate` (Number) The sampling rate from 0 to 1 (e.g., 0.1 for 10%).
- `type` (String) The sampling type. Only `head_sampling` is supported.

Optional:

- `environment` (String) The environment to apply sampling to. Valid values are `production` or `preview`.
- `request_path` (String) Request path prefix to apply the sampling rule to.


<a id="nestedatt--transforms"></a>
### Nested Schema for `transforms`

Required:

- `id` (String) The transform ID.

## Import

Import is supported using the following syntax:

```shell
# If importing into a personal account, or with a team configured on
# the provider, simply use the drain ID.
terraform import vercel_drain.example drn_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Alternatively, you can import via the team_id and drain_id.
terraform import vercel_drain.example team_xxxxxxxxxxxxxxxxxxxxxxxx/drn_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```
